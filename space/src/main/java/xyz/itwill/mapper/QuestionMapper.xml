<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="xyz.itwill.mapper.QuestionMapper">
	
	<!-- review 게시글 삽입 -->
		<insert id="insertQuestion">
			<selectKey resultType="int" keyProperty="qNo" order="BEFORE">
				select question_seq.nextval from dual
			</selectKey>
			insert into question values(#{qNo}, #{qTitle}, #{qContent}, #{qImg},1 ,sysdate,1,#{qMid},#{qHid}, #{qSno}, #{qCount})	
	</insert>
	<!-- notice 게시글 변경 (변경값이 있을 경우에만 변경) -->
	<update id="updateQuestion">
		update question
		<set>
			<if test="rTitle!=null and rTitle!=''">
				q_title=#{qTitle},
			</if>
			<if test="rContent!=null and rContent!=''">
				q_content=#{qContent},
			</if>
			<if test="rStatus==0 or rStatus==1">
				q_status=#{qStatus},
			</if>
			
			<if test="qMstatus==0 or qRstatus==1">
				q_mstatus=#{qMstatus}
			</if>
		</set>
		where q_No=#{qNo}
	</update>
	<delete id="deleteQuestion">
		delete from question where q_no=#{qNo}
	</delete>
	
	<select id="selectQuestionCount" resultType="int">
		select count(*) from question
	</select>
	
	<select id="selectQuestion" resultType="Question">
		select * from question where q_no=#{qNo}
	</select>
	
	<select id="selectQuestionList" resultType="Question">
		select * from (select rownum rn, space.* from (select * from question 
			order by qNo desc) space) where rn between #{startRow} and #{endRow}
	</select>
</mapper>
	